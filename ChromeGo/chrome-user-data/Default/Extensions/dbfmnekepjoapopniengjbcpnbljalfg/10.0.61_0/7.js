(window.webpackJsonp=window.webpackJsonp||[]).push([[7,13,40],{122:function(t,e,i){"use strict";i.r(e),i.d(e,"iMessage",(function(){return h})),i.d(e,"message",(function(){return u}));i(13),i(17);var o=i(358),s=i(1),n=i(344),r=i(393),a=i.n(r),c=i(394),l=i.n(c),p=function(t,e,i,o){var s,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(n<3?s(r):n>3?s(e,i,r):s(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};let h=class extends s.a{constructor(){super(...arguments),this.content="",this.type="error"}render(){const t={"infinity-message":!0,"position-top":"top"===this.type};return s.e`
      <div class=${Object(n.a)(t)}>
        ${this.renderImg()}
        <span>${this.content}</span>
      </div>
    `}renderImg(){return"error"===this.type?s.e`<img .src=${a.a} />`:"warn"===this.type?s.e`<img .src=${l.a} />`:void 0}};h.styles=s.b`
    :host {
      box-sizing: border-box;
      display: flex;
      position: fixed;
      min-width: 330px;
      padding: 0 20px;
      height: 60px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 1);
      box-shadow: 0px 6px 48px 0px rgba(0, 0, 0, 0.24);
      border-radius: 6px;
      z-index: 99999999999;
    }
    :host([type='top']) {
      width: 100%;
      margin: 0;
      left: 0;
      top: var(--top-bar-height);
      height: auto;
      padding: 5px;
      border-radius: 0;
      background: rgba(95, 92, 92, 0.6);
      color: #fff;
      transform: none;
      transition: all 300ms;
      opacity: 0;
      pointer-events: none;
    }
    :host(.anim[type='top']) {
      opacity: 1;
    }

    .infinity-message {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
    }
    img {
      width: 20px;
      height: 20px;
      margin-right: 8px;
    }
  `,p([Object(s.g)({type:String})],h.prototype,"content",void 0),p([Object(s.g)({type:String})],h.prototype,"type",void 0),h=p([Object(s.c)("i-message")],h);const u={newInstance:function(t,e=2,i,o){let s;if(document.querySelector("i-message"))return void clearInterval(s);const n=document.createElement("i-message");return n.setAttribute("content",t),n.setAttribute("type",i),document.body.appendChild(n),0!==e&&(s=setTimeout(()=>{document.body.removeChild(n),o&&o()},1e3*e)),n},error:function(t,e,i){o.default.error(t,e),i&&setTimeout(i,e)},success:function(t,e,i){o.default.success(t,e),i&&setTimeout(i,e)},top:function(t,e,i){const o=this.newInstance(t,e,"top",i);setTimeout(()=>null==o?void 0:o.classList.add("anim"))},warn:function(t,e,i){this.newInstance(t,e,"warn",i)}}},178:function(t,e,i){"use strict";i.r(e),i.d(e,"slave",(function(){return a}));i(10),i(13),i(17),i(52);var o=i(7),s=i.n(o),n=i(259),r=i(123);const a=new class{constructor(){if(this.channel=null,this.initResolve=[],this.initReject=[],this.messageScheduler=new n.a,this.initChannel=()=>{"serviceworker"===r.b?this.initServiceworker():"background"===r.b&&this.initBackground()},this.awaitChannel=()=>new s.a(async(t,e)=>{"serviceworker"===r.b?this.channel?(await this.channel.active,await this.channel.controlling,t(null)):(this.initResolve.push(t),this.initReject.push(e)):"background"===r.b&&t(null)}),this.initServiceworker=async()=>{try{const{createWorkBox:t}=await i.e(12).then(i.bind(null,575)),e=await t();if(!e)return;e.addEventListener("message",t=>{const{type:e,payload:i={}}=t.data;"master:bordcast-message"===e&&this.messageScheduler.execTask(i.type,i.payload)}),await e.active,await e.controlling,this.channel=e,this.initResolve.forEach(t=>{t()}),this.channel.postTask=this.channel.messageSW}catch(t){console.log("slave初始化错误：",t),this.initReject.forEach(t=>{t()})}},this.initBackground=()=>{this.channel={postTask:t=>new s.a((e,i)=>{chrome.runtime.sendMessage(t,t=>{chrome.runtime.lastError&&i(chrome.runtime.lastError),e(t)})})},chrome.runtime.onMessage.addListener(({type:t,payload:e,ignoreId:i})=>{"master:bordcast-message"===t?chrome.tabs.getCurrent(t=>{i!==t.id&&this.messageScheduler.execTask(e.type,e.payload)}):"slave:bordcast-message"===t&&this.messageScheduler.execTask(e.data.type,e.data.payload)})},r.a)throw new Error("it's not page");this.initChannel()}postTask(t,e,i){return new s.a(async(o,s)=>{let n=!1;await this.awaitChannel();const a=Object.assign(Object.assign(Object.assign({},r.d),{taskId:Object(r.c)()}),i);a.timeout&&setTimeout(()=>{n||o({error:"timeout"})},a.timeout);try{const i=await this.channel.postTask({type:t,payload:Object.assign({data:e},a)});n=!0,o(i)}catch(t){o({error:t})}})}listenMessage(t,e){this.messageScheduler.listenTask(t,e)}sendMessage(t,e=""){this.postTask("slave:bordcast-message",{type:t,payload:e})}}},246:function(t,e,i){"use strict";i.d(e,"a",(function(){return l})),i.d(e,"b",(function(){return p}));i(13),i(17),i(10),i(52);var o=i(3),s=i(22),n=i(178),r=function(t,e,i,o){var s,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(n<3?s(r):n>3?s(e,i,r):s(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};const a={},c=new Set;class l{constructor(){this.firstSync=!1,this.syncTabTime=0,this._lockRollback=!1,this.isRollbackFromStorage=!1,this.backupFileKey="",this.backupValueKeys=[],this.rollbackFromStorage=()=>null,this.stopToStorageReaction=()=>{},this.stopAutoBackupReaction=()=>{},this.convertBackupEquals=t=>t}async initSyncStore(t,e,i={},r,c=20){if(a[t])throw new Error("storage key 重复");a[t]=this,0!==e.length&&(this.rollbackFromStorage=async()=>{let n=!1;const a=Object.create(null);Object.keys(i).forEach(t=>{e.includes(t)&&(a[t]=i[t])});try{const i=await Object(s.b)(t,r),o=i?Object.keys(i):[];i&&o.forEach(t=>{e.includes(t)&&(a[t]=i[t])}),this.firstSync||i&&!e.some(t=>!o.includes(t))||(n=!0)}catch(t){console.error("storageSync",t)}this.isRollbackFromStorage=!0,this.stopToStorageReaction(),this.stopAutoBackupReaction(),Object(o.i)(()=>{for(const t in a)this[t]=a[t];this.firstSync||(this.firstSync=!0)}),this.restartAutoBackupReaction(),this.stopToStorageReaction=Object(o.h)(()=>{const t={};return e.forEach(e=>{t[e]=Object(o.j)(this[e])}),t},e=>{this.isRollbackFromStorage=!1,Object(s.e)(t,e,r),Object(o.i)(()=>{this.syncTabTime=Date.now()})},{equals:o.d.structural,delay:c,fireImmediately:n})},await this.rollbackFromStorage(),Object(o.h)(()=>this.syncTabTime,e=>{e&&n.slave.sendMessage("tabs-sync",t)},{delay:60}))}restartAutoBackupReaction(t=!1){this.stopAutoBackupReaction(),this.stopAutoBackupReaction=Object(o.h)(()=>{const t={};return this.backupValueKeys.forEach(e=>{t[e]=Object(o.j)(this[e])}),t},t=>{(async(t,e)=>{try{const{syncStore:o}=await Promise.all([i.e(6),i.e(8),i.e(34)]).then(i.bind(null,574));o.pushAutoBackupPipe({[t]:e})}catch(t){}})(this.backupFileKey,t).catch()},{fireImmediately:t,equals:(t,e)=>{const i=this.convertBackupEquals(t),s=this.convertBackupEquals(e);return o.d.structural(i,s)},delay:40})}initAutoBackup(t,e){if(c.has(t))throw new Error("file key 重复");c.add(t),0!==e.length&&(this.backupFileKey=t,this.backupValueKeys=[...e])}async getBackupData(){const t={};return this.backupValueKeys.forEach(e=>{t[e]=Object(o.j)(this[e])}),t}}r([o.g],l.prototype,"firstSync",void 0),r([o.g],l.prototype,"syncTabTime",void 0),r([o.b],l.prototype,"initSyncStore",null);const p=t=>{const e=a[t];(null==e?void 0:e._lockRollback)||e.rollbackFromStorage()}},247:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));i(10),i(13),i(17),i(52);var o=i(0),s=i(398),n=i(48),r=i.n(n),a=i(5);var c=i(81);const l=new class{constructor(){this.ga=null,this.localKey="analytics-status-time",this.gap=432e5,this.getPermission=async()=>{let t=!0;if(o.n)try{const{privacyStore:e}=await Promise.all([i.e(6),i.e(8),i.e(33)]).then(i.bind(null,581));1!==e.collectData&&(t=!1)}catch(e){t=!1}return t},this.trySendStatus=t=>{const e=localStorage.getItem(this.localKey);e?(Date.now()-Number(e)>this.gap||Number(e)>Date.now())&&this.sendStatus(t):this.sendStatus(t)},this.sendPageView=async t=>{if(!await this.getPermission())return;const e=this.ga.getPageviewUrl(t);c.c.sendLog(e)},this.sendEvent=async(t,e=!1)=>{await this.getPermission()&&Object.keys(t).forEach(i=>{const o=t[i];if("object"==typeof o)Object.keys(o).forEach(t=>{const s=o[t],n=this.ga.getEventUrl({category:i,action:t,label:String(s),nonInteraction:e});c.c.sendLog(n)});else{const t=this.ga.getEventUrl({category:i,action:String(o),nonInteraction:e});c.c.sendLog(t)}})},this.sendBaidu=async t=>{await this.getPermission()&&(async(t="")=>{const e=o.C.runtimePlatform;if(null==t?void 0:t.includes("baidu.com")){const i=new r.a(t).searchParams.get("tn"),s=`https://manage-api.infinitytab.com/analysis-manager/send/60efd763a741942ac60374e1?label=${o.B.baiduLabel}&action=${i}&event=${e}`;o.r?navigator.sendBeacon(s):a.a.post(s,null,{_proxy:!0})}})(t)},this.ga=new s.a({trackingId:o.B.trackingId})}async sendStatus(t){try{this.sendEvent(t,!0),localStorage.setItem(this.localKey,""+Date.now())}catch(t){}}}},345:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var o=i(107),s=i.n(o),n=(i(13),i(17),i(10),i(3)),r=i(368),a=i.n(r),c=i(246),l=i(14),p=function(t,e,i,o){var s,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(n<3?s(r):n>3?s(e,i,r):s(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};const h=[{text:i18n("todo_welcome"),todoId:"todo-id1dtkk87it2iepal6dv4hr2uig0c",time:Date.now(),updatetime:0,done:!1}];class u extends c.a{constructor(){super(...arguments),this.todoList=h,this.currenetState="done",this.listLength=localStorage.getItem("todo-length")||0}toggleState(t){this.currenetState=t}get needNotificationPermission(){return this.todoList.some(t=>!!t.dueDate)}diffRemote(t){const e=t=>{if(null==t?void 0:t.updatetime){const e={updatetime:void 0};return t.done=!!t.done,Object.assign(Object.assign({},t),e)}},i=a()(t.todoList||[],e),o=a()(Object(n.j)(this.todoList),e);return!n.d.structural(i,o)}mergeRemote(t,e){if(t.todoList)if(e)this.todoList=t.todoList;else{const e=this.todoList,i=t.todoList,{result:o}=l.a.mergeArray(e,i,"todoId");this.todoList=o}}edit(t){this.todoList=this.todoList.map(e=>e.todoId===t?Object.assign(Object.assign({},e),{edit:!e.edit}):e)}get hasDoneTodo(){return this.todoList.filter(t=>t.done).length}async addTodo(t){if(!s()(t).call(t).length)return;const e={done:!1,time:+new Date,todoId:l.a.randomId("todo-"),updatetime:await l.a.getTimestamp(),text:t};Object(n.i)(()=>{this.todoList=[e,...this.todoList]})}removeTodo(){this.todoList=this.todoList.filter(t=>!t.done)}deleteTodo(t){this.todoList=this.todoList.filter(e=>e.todoId!==t)}async toggleTodo(t){const e=await l.a.getTimestamp();Object(n.i)(()=>{this.todoList=this.todoList.map(i=>i.todoId===t?Object.assign(Object.assign({},i),{done:!i.done,updatetime:e}):Object.assign({},i))})}async updateTodo(t,e){const i=await l.a.getTimestamp();Object(n.i)(()=>{this.todoList=this.todoList.map(o=>o.todoId===t?Object.assign(Object.assign(Object.assign({},o),e),{updatetime:i,edit:!1}):Object.assign({},o))})}removeTime(t){this.todoList=this.todoList.map(e=>e.todoId===t?Object.assign(Object.assign({},e),{dueDate:"",dueTime:"",dueTimestamp:null}):e)}}p([n.g],u.prototype,"todoList",void 0),p([n.g],u.prototype,"currenetState",void 0),p([n.b],u.prototype,"toggleState",null),p([n.e],u.prototype,"needNotificationPermission",null),p([n.b],u.prototype,"mergeRemote",null),p([n.b],u.prototype,"edit",null),p([n.g],u.prototype,"listLength",void 0),p([n.e],u.prototype,"hasDoneTodo",null),p([n.b],u.prototype,"addTodo",null),p([n.b],u.prototype,"removeTodo",null),p([n.b],u.prototype,"deleteTodo",null),p([n.b],u.prototype,"toggleTodo",null),p([n.b],u.prototype,"updateTodo",null),p([n.b],u.prototype,"removeTime",null);const d=new u;d.initSyncStore("store-todo",["todoList","listLength"],{},!0),d.initAutoBackup("todo",["todoList"]),Object(n.c)(()=>{if(d.firstSync){const t=d.todoList.filter(t=>!t.done).length;Object(n.i)(()=>{d.listLength=t}),localStorage.setItem("todo-length",t+"")}}),Object(n.c)(()=>{let t=!1;const{todoList:e}=d;for(let i=0;i<e.length-1;i++){const{done:o}=e[i],s=e[i+1].done;if(o&&!s){t=!0;break}}t&&(Object(n.i)(()=>{const t=e.filter(t=>t.done),i=e.filter(t=>!t.done);d.todoList=[...i,...t]}),t=!1)},{delay:300})},358:function(t,e,i){"use strict";i.r(e);var o=i(7),s=i.n(o),n=(i(13),i(17),i(245)),r=i(390),a=i(1),c=i(3),l=a.b`.i-bubble {
  position: fixed;
  top: 80px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 99999999;
}
.i-bubble.network-error .i-bubble-wrap,
.i-bubble.error .i-bubble-wrap,
.i-bubble.success .i-bubble-wrap {
  padding-left: 30px;
  padding-right: 32px;
}
.i-bubble + .i-bubble-mask {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(255, 255, 255, 0.7);
  z-index: 999999;
  display: none;
  opacity: 0;
  transition: opacity 150ms ease-in 0s;
}
.i-bubble.loading + .i-bubble-mask {
  display: block;
}
.i-bubble.loading.popup + .i-bubble-mask {
  opacity: 1;
}
.i-bubble .i-bubble-wrap {
  margin: 0 auto;
  box-sizing: border-box;
  padding: 12px 20px;
  background-color: #333;
  box-shadow: 0px 2px 20px 0px rgba(0, 0, 0, 0.1);
  border-radius: 4px;
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  font-size: 14px;
  line-height: 1.4em;
  transition: opacity 0.15s cubic-bezier(0, 0, 0.2, 1) 0ms, transform 0.15s cubic-bezier(0, 0, 0.2, 1) 0ms;
  transform: scale(0.8);
  opacity: 0;
  box-shadow: 0 3px 5px -1px rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.14), 0 1px 18px 0 rgba(0, 0, 0, 0.12);
  max-width: 600px;
}
.i-bubble.popup .i-bubble-wrap {
  transform: scale(1);
  opacity: 1;
}
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}
.i-bubble .icon {
  width: 18px;
  height: 18px;
  flex-shrink: 0;
  margin-right: 12px;
  display: none;
}
.i-bubble .icon.icon-loading {
  animation: spin 700ms linear infinite;
}
.i-bubble .i-bubble-text {
  color: #e4e4e4;
  display: block;
  box-sizing: border-box;
  flex-grow: 1;
  width: 100%;
  word-break: break-all;
}
.i-bubble .i-bubble-button {
  width: 70px;
  height: 28px;
  color: #4caf50;
  background-color: initial;
  border: none;
  padding: 0;
  cursor: pointer;
  transition: color, background-color 200ms;
  border-radius: 4px;
  outline: none;
  max-width: 180px;
  margin-left: 46px;
  flex-shrink: 0;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.i-bubble .i-bubble-button:hover {
  background-color: rgba(76, 175, 80, 0.14);
}
`,p=i(14),h=i(23),u=function(t,e,i,o){var s,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(n<3?s(r):n>3?s(e,i,r):s(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};const d=Object(h.a)("network-error.png",!1),g=Object(h.a)("error.png",!1),b=Object(h.a)("success.png",!1),m=Object(h.a)("loading.png",!1);class y extends n.a{constructor(){super(...arguments),this.popup=!1,this.showButton=!1}static _timeToHideHandler(t){if(t.showButton){const e=t.shadowRoot.querySelector(".i-bubble .i-bubble-button");e.onclick&&(e.onclick=null)}const e=t.shadowRoot.querySelector(".i-bubble > .i-bubble-wrap");let i=!1;const o=()=>{t.onmouseenter=null,t.onmouseleave=null,document.body.contains(t)&&document.body.removeChild(t),i=!0};e.addEventListener("transitionend",o,{once:!0}),e.addEventListener("transitioncancel",o,{once:!0}),setTimeout(()=>{i||o()},150),t.setPopup(!1)}static _setTimerToHide(t,e){this._clearTimerToHide(t),t.hideTimer=setTimeout(()=>this._timeToHideHandler(t),e)}static _clearTimerToHide(t){t.hideTimer&&(clearTimeout(t.hideTimer),t.hideTimer=null)}static _messageMisc(t,e,i){this.setText(t),document.body.appendChild(this),window.customElements.whenDefined("i-bubble").then(()=>(this.offsetWidth,this.setPopup(!0),new s.a(t=>requestAnimationFrame(t)))).then(()=>{i&&i(this)}),e>0&&y._setTimerToHide(this,e)}static message(t,e){const i=document.createElement("i-bubble");i.setType("message"),e=null!=e?e:this.duration,this._messageMisc.call(i,t,e)}static networkError(t,e){const i=document.createElement("i-bubble");i.setType("network-error"),e=null!=e?e:this.duration,this._messageMisc.call(i,t,e)}static success(t,e){const i=document.createElement("i-bubble");i.setType("success"),e=null!=e?e:this.duration,this._messageMisc.call(i,t,e)}static error(t,e){const i=document.createElement("i-bubble");i.setType("error"),e=null!=e?e:this.duration,this._messageMisc.call(i,t,e)}static popupLogin(t){const e=this.popup(i18n("reqeust_login_message"),{showButton:!0,btnValue:i18n("to_login"),type:"message",onBtnClick:null!=t?t:()=>{r.userStore.openModal()}}),i=Date.now();let o=this.duration2;e.onmouseenter=()=>{o=Date.now()-i,y._clearTimerToHide(e)},e.onmouseleave=()=>{y._setTimerToHide(e,o)}}static popupLoading(t){const e=this.popup(i18n("wallpaper_loading"),{duration:0,showButton:!0,btnValue:i18n("cancel"),type:"loading",onBtnClick:t});return()=>setTimeout(()=>this._timeToHideHandler(e),y.waitForReady)}static loading(t){const e=this.popup(t,{type:"loading",duration:0});return()=>setTimeout(()=>this._timeToHideHandler(e),y.waitForReady)}static popup(t,e){const{duration:i=this.duration2,btnValue:o,onBtnClick:s,type:n,showButton:r}=e,a=document.createElement("i-bubble");return a.setType(n),o&&a.setBtnValue(o),r&&a.setShowButton(r),this._messageMisc.call(a,t,i,()=>{if(a.showButton){a.shadowRoot.querySelector(".i-bubble .i-bubble-button").onclick=t=>{s&&s(t),this._timeToHideHandler(a)}}}),a}firstUpdated(){const t="\n      background-size: cover;\n      background-repeat: no-repeat;\n      background-position: center;\n      display: block;\n    ",e=document.createElement("style");e.appendChild(document.createTextNode(`\n      .i-bubble .icon.icon-network-error{\n        background-image: url(${d});${t}\n      }\n      .i-bubble .icon.icon-success{\n        background-image: url(${b});${t}\n      }\n      .i-bubble .icon.icon-error{\n        background-image: url(${g});${t}\n      }\n      .i-bubble .icon.icon-loading{\n        background-image: url(${m});${t}\n      }\n      `)),this.shadowRoot.appendChild(e)}render(){return a.e`
      <section class="i-bubble ${this.type}${this.popup?" popup":""}">
        <section class="i-bubble-wrap">
          <i class="icon icon-${this.type}"></i>
          <span class="i-bubble-text">${this.text}</span>
          <input
            class="i-bubble-button"
            type="button"
            .value=${this.btnValue}
            style="${this.showButton?"":"display: none;"}"
          />
        </section>
      </section>
      <section class="i-bubble-mask" @click=${p.a.stopBubble}></section>
    `}setType(t){this.type=t}setText(t){this.text=t}setBtnValue(t){this.btnValue=t}setPopup(t){this.popup=t}setShowButton(t){this.showButton=t}}y.duration=3e3,y.duration2=5e3,y.waitForReady=1e3/60,y.styles=l,u([c.g],y.prototype,"type",void 0),u([c.g],y.prototype,"text",void 0),u([c.g],y.prototype,"btnValue",void 0),u([c.g],y.prototype,"popup",void 0),u([c.g],y.prototype,"showButton",void 0),u([c.b],y.prototype,"setType",null),u([c.b],y.prototype,"setText",null),u([c.b],y.prototype,"setBtnValue",null),u([c.b],y.prototype,"setPopup",null),u([c.b],y.prototype,"setShowButton",null),window.customElements.define("i-bubble",y);e.default=y},359:function(t,e,i){"use strict";i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return n}));i(13),i(17);class o{constructor(){this._caches={},this._setCaches=t=>(...e)=>{this._caches[t]=e}}}const s=[],n=t=>new Proxy(t,{set:(t,e,i)=>null===i?(t[e]=i,!0):"function"==typeof t[e]?(console.warn("失败：重复注册"),!0):(t[e]=i,s.includes(e)&&delete t._caches[e],t._caches.hasOwnProperty(e)&&(t[e](...t._caches[e]),delete t._caches[e]),!0),get:(t,e)=>"function"==typeof t[e]?t[e]:t._setCaches(e)})},360:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var o=i(7),s=i.n(o),n=(i(10),i(0)),r=i(97);async function a(){if(n.r){if("granted"!==await new s.a(t=>{!function(){try{Notification.requestPermission().then()}catch(t){return!1}return!0}()?Notification.requestPermission(t):Notification.requestPermission().then(t)}))throw new Error}else await r.a.request(["notifications"])}},390:function(t,e,i){"use strict";i.r(e),i.d(e,"userStore",(function(){return S}));i(10),i(52),i(13),i(17),i(18);var o=i(7),s=i.n(o),n=i(251),r=i.n(n),a=i(105),c=i.n(a),l=i(3),p=i(246),h=i(81),u=i(0),d=i(122),g=i(26),b=i.n(g),m=i(188),y=i(178),f=i(392),w=i(391),k=function(t,e,i,o){var s,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(n<3?s(r):n>3?s(e,i,r):s(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};class v extends p.a{constructor(){super(),this.isExpired=!1,this.isLogin=!1,this.token="",this.userInfo={},this.refreshToken="",this.mobileloginExpire=0,this.mobileloginUrl="",this.userProfilePromise=s.a.resolve(),this.wpColorUpdate=0,this.logining=!1,this.modalOpen=!1,this.removeAccountDisableSec=10,this.removeAccountDisableTimer=null,this.showLoginTipModal=!1,this.profileModal=!1,this.syncListModal=!1,this.isModify=!1,this.countdownTimer=null,this.checkMobileUrlTimer=null,this.isShowLogoutConfirm=!1,this.showConfirmOpt="",this.clearAllData=!1,this.loading=!1,this.URL=u.x}setWpColorUpdate(t){this.wpColorUpdate=t}closeModal(){this.modalOpen=!1}openModal(){this.modalOpen=!0}toggleLoginTipModal(){this.showLoginTipModal=!this.showLoginTipModal}closeLoginTipModal(){this.showLoginTipModal=!1}closeProfileModal(){this.profileModal=!1}openProfileModal(){this.profileModal=!0}closeSyncListModal(){this.syncListModal=!1}openSyncListModal(){this.syncListModal=!0}openModify(){this.isModify=!0}async modifyProfile(t){try{const e=await h.g.updateProfile(t);Object(l.i)(()=>{if(e&&0===e.code){const{user:{name:t,gender:i,avatar:o}}=e.data;this.userInfo.name=t,this.userInfo.gender=i,this.userInfo.avatar=o,this.closeModify()}else d.message.error(i18n("update_data_failure"))})}catch(t){d.message.error(t.message)}}async getUserProfile(){const t=await h.g.getUserProfile();Object(l.i)(()=>{if(t)if(0===t.code&&this.isLogin){const{gender:e,name:i,avatar:o}=t.data;this.userInfo.name=i,this.userInfo.gender=e,this.userInfo.avatar=o,this.userInfo["auto-backup"]=t.data["auto-backup"],this.userInfo["wp-color-update"]=t.data["wp-color-update"]}else 3012===t.code&&(d.message.error(t.message),this.exitAccount())})}async updateAvatar(t){try{return await h.g.uploadAvatar(t)}catch(t){d.message.error(i18n("upload_avatar_failure"))}}closeModify(){this.isModify=!1}thirdPartyLogin(t){let e;switch(this.logining=!0,t){case"facebook":e=this.URL+"/login/facebook";break;case"google":e=this.URL+"/login/google";break;case"qq":const t=encodeURIComponent("https://infinity-api.infinitynewtab.com/on-login/qq");e="https://graph.qq.com/oauth2.0/show?which=Login&display=pc&response_type=code&client_id=101410947&redirect_uri="+t;break;case"sina":e=this.URL+"/login/weibo";break;case"wechat":const i=encodeURIComponent("https://infinity-api.infinitynewtab.com/on-login/wechat");e="https://open.weixin.qq.com/connect/qrconnect?state=123&appid=wx5af98300f5d18d16&response_type=code&scope=snsapi_login&redirect_uri="+i}setTimeout(async()=>{const t=Math.floor(window.screenY+200),i=Math.floor(window.screenX+window.innerWidth/3),o=window.open(e,"_blank",`top=${t},left=${i},height=600,width=770,menubar=no,toolbar=yes,location=yes,status=no,resizable=no`);if(this.opener=o,u.n)return;const s=setInterval(()=>{o.postMessage({from:"origin_login"},"*")},300),n=t=>{if(!t.data&&!t.data.key&&"login"!==t.data.key)return;clearInterval(s),window.removeEventListener("message",n,!1);const{message:e}=t.data;this.login3rdSuccess(e)};window.addEventListener("message",n,!1)},300)}async login(t){const e=await h.g.login(t);Object(l.i)(()=>{if(!e||0!==e.code)throw d.message.error(e.message),new Error(e.code);this.loginEmailSuccess(e.data.user),this.setToken(e.data),this.setRefreshToken(e.data.refreshToken)})}async getMobileloginUrl(t=!1){if(t&&(this.mobileloginUrl="",this.mobileloginExpire=0),m.e){const{data:t,error:e}=await h.g.getMobileloginUrl();if(e)return void Object(l.i)(()=>{this.mobileloginExpire=0});Object(l.i)(()=>{this.mobileloginUrl=t.url,this.mobileloginExpire=Math.floor(t.expire/1e3)}),this.checkMobileloginUrl(t.code,t.type),0!==this.mobileloginExpire&&(this.countdownTimer=setInterval(()=>{Object(l.i)(()=>{this.mobileloginExpire-=1}),this.mobileloginExpire<=0&&clearInterval(this.countdownTimer)},1e3))}}async checkMobileloginUrl(t,e,i=5e3){m.e&&this.mobileloginExpire>3&&(clearTimeout(this.checkMobileUrlTimer),this.checkMobileUrlTimer=setTimeout(async()=>{const{data:o}=await h.g.checkMobileloginUrl(t,e);if(o&&o.expired)return clearInterval(this.countdownTimer),void Object(l.i)(()=>{this.mobileloginExpire=0});this.checkMobileloginUrl(t,e,i)},i))}async loginEmailSuccess(t){this.logining=!1,this.closeModal(),this.isLogin=!0,this.userInfo=t,this.isExpired=!1,this.settingLoginSuccess()}setUserData(t){this.logining=!1,this.closeModal(),this.isLogin=t.isLogin,this.userInfo=t,this.isExpired=!1;["token","refreshToken","isLogin"].forEach(t=>delete this.userInfo[t])}async login3rdSuccess(t){if(!t||!Object.keys(t).length)return void this.cancelLogin();const e=t["login-type"];if(["qq","wechat"].includes(e)){const e=await h.g.loginWithUid(t);0===e.code?Object(l.i)(()=>{this.setUserData(t),this.setToken(e.data),this.setRefreshToken(e.data.refreshToken)}):3006===e.code&&d.message.error("获取token失败")}else this.setUserData(t),this.setToken(t),this.setRefreshToken(t.refreshToken);this.settingLoginSuccess()}settingLoginSuccess(){w.b.changeSetting("view","isHideIcp",!0)}cancelLogin(){var t;this.logining=!1,null===(t=this.opener)||void 0===t||t.close()}toggleClear(t){this.clearAllData=t}logout(t){this.isShowLogoutConfirm=!0,this.showConfirmOpt=t,"remove"===t&&(this.removeAccountDisableSec=10,clearInterval(this.removeAccountDisableTimer),this.removeAccountDisableTimer=setInterval(()=>{Object(l.i)(()=>{this.removeAccountDisableSec-=1,0===this.removeAccountDisableSec&&(clearInterval(this.removeAccountDisableTimer),this.removeAccountDisableTimer=null)})},1e3))}async exitAccount(){this.loading=!0,this.isLogin=!1,this.userInfo={},this.clearToken(),await new s.a(t=>{setTimeout(()=>{this.clearAllData?this.clearAllStore().then(t):t(null)},200)}),this.clearAllData?window.location.reload():(Object(l.i)(()=>this.loading=!1),this.closeLogoutConfirm(),this.closeProfileModal(),u.r&&f.pluginStore.hideLast())}async deleteAccount(){this.loading=!0;const t=await h.g.deleteAccount();Object(l.i)(()=>{t&&0===t.code?this.exitAccount():(3012===t.code&&this.exitAccount(),d.message.error(t.message)),this.loading=!1})}preserveStorageKeys(){const t=[];return["store-privacy"].forEach(e=>t.push({key:e,data:localStorage.getItem(e)})),t}restoreKeysToStorage(t){t.forEach(({data:t,key:e})=>localStorage.setItem(e,t))}async clearAllStore(){this.stopAutoBackupReaction(),this.stopToStorageReaction();!u.r&&await new s.a(t=>chrome.storage.local.clear(t)),this._clearLocalStorage(["store-privacy","store-setting->permission","store-search->ignoreSuggest","first-installed"]),await this._deleteIdb(["store-notes","store-todo","store-sync","store-wallpaper","store-wallpaper-cache","infinity-image-base64"]),y.slave.sendMessage("tabs-reload")}async _deleteIdb(t){const e=await new s.a(t=>r()(b.a).call(b.a,(e,i)=>t(i)));await s.a.all(t.map(t=>new s.a(i=>{const o=t.split("->");if(1===o.length)return e.includes(t)?void b.a.removeItem(t,i):void i(null);i(null),e.includes(o[0])&&b.a.getItem(o[0],t=>{c()(o).call(o,(t,e,i)=>(i===o.length-1&&Reflect.deleteProperty(t,e),t[e]),t),b.a.setItem(o[0],i)})})))}_clearLocalStorage(t){const e=new Map;t.filter(Boolean).forEach(t=>{const i=t.split("->");if(1===i.length)return void e.set(t,localStorage.getItem(t));const o=JSON.parse(localStorage.getItem(i[0]));i.slice(1).forEach((t,e)=>{const s=0===e?o:o[i[e]];for(const e in s)t!==e&&Reflect.deleteProperty(s,e)}),e.set(i[0],JSON.stringify(o))}),localStorage.clear();for(const t of r()(e).call(e))localStorage.setItem(t,e.get(t))}closeLogoutConfirm(){this.isShowLogoutConfirm=!1}setToken(t){this.token=t.token}setRefreshToken(t){this.refreshToken=t}clearToken(){this.token="",this.refreshToken=""}setOutdated(){this.isExpired=!0,this.isLogin=!1}toggleReLogin(){this.isExpired=!1}}k([l.g],v.prototype,"isExpired",void 0),k([l.g],v.prototype,"isLogin",void 0),k([l.g],v.prototype,"token",void 0),k([l.g],v.prototype,"userInfo",void 0),k([l.g],v.prototype,"refreshToken",void 0),k([l.g],v.prototype,"mobileloginExpire",void 0),k([l.g],v.prototype,"mobileloginUrl",void 0),k([l.g],v.prototype,"wpColorUpdate",void 0),k([l.b],v.prototype,"setWpColorUpdate",null),k([l.g],v.prototype,"opener",void 0),k([l.g],v.prototype,"logining",void 0),k([l.g],v.prototype,"modalOpen",void 0),k([l.g],v.prototype,"removeAccountDisableSec",void 0),k([l.g],v.prototype,"removeAccountDisableTimer",void 0),k([l.b],v.prototype,"closeModal",null),k([l.b],v.prototype,"openModal",null),k([l.g],v.prototype,"showLoginTipModal",void 0),k([l.b],v.prototype,"toggleLoginTipModal",null),k([l.b],v.prototype,"closeLoginTipModal",null),k([l.g],v.prototype,"profileModal",void 0),k([l.g],v.prototype,"syncListModal",void 0),k([l.b],v.prototype,"closeProfileModal",null),k([l.b],v.prototype,"openProfileModal",null),k([l.b],v.prototype,"closeSyncListModal",null),k([l.b],v.prototype,"openSyncListModal",null),k([l.g],v.prototype,"isModify",void 0),k([l.b],v.prototype,"openModify",null),k([l.b],v.prototype,"modifyProfile",null),k([l.b],v.prototype,"getUserProfile",null),k([l.b],v.prototype,"updateAvatar",null),k([l.b],v.prototype,"closeModify",null),k([l.b],v.prototype,"thirdPartyLogin",null),k([l.b],v.prototype,"login",null),k([l.b],v.prototype,"getMobileloginUrl",null),k([l.b],v.prototype,"checkMobileloginUrl",null),k([l.b],v.prototype,"loginEmailSuccess",null),k([l.b],v.prototype,"setUserData",null),k([l.b],v.prototype,"login3rdSuccess",null),k([l.b],v.prototype,"cancelLogin",null),k([l.g],v.prototype,"isShowLogoutConfirm",void 0),k([l.g],v.prototype,"showConfirmOpt",void 0),k([l.g],v.prototype,"clearAllData",void 0),k([l.b],v.prototype,"toggleClear",null),k([l.b],v.prototype,"logout",null),k([l.g],v.prototype,"loading",void 0),k([l.b],v.prototype,"exitAccount",null),k([l.b],v.prototype,"deleteAccount",null),k([l.b],v.prototype,"clearAllStore",null),k([l.b],v.prototype,"closeLogoutConfirm",null),k([l.b],v.prototype,"setToken",null),k([l.b],v.prototype,"setRefreshToken",null),k([l.b],v.prototype,"clearToken",null),k([l.b],v.prototype,"setOutdated",null),k([l.b],v.prototype,"toggleReLogin",null);const S=new v;Object(l.c)(()=>{S.isLogin&&(S.userProfilePromise=S.getUserProfile())}),S.initSyncStore("store-user",["userInfo","isLogin","token","refreshToken","wpColorUpdate"])},391:function(t,e,i){"use strict";i.d(e,"b",(function(){return b})),i.d(e,"a",(function(){return y}));i(13),i(17),i(18),i(10),i(52);var o=i(3),s=i(246),n=i(14),r=i(97),a=i(130),c=i(250),l=i(0),p=i(345),h=i(360),u=i(247),d=function(t,e,i,o){var s,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(n<3?s(r):n>3?s(e,i,r):s(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};class g extends s.a{constructor(){super(...arguments),this.localSettings={},this.innerWidth=window.innerWidth,this.innerHeight=window.innerHeight,this.iconSpaceWidth=0,this.iconSpaceHeight=0,this.setting=this.init(),this.updatetime=0,this.permission={topUseful:-1,topBookmark:-1,searchSuggest:-1,gmailNotice:-1,gmailCount:-1,todoNotice:-1},this.logs=new Map,this.permissionMapper={topBookmark:[["bookmarks"],["chrome://favicon/"]],topUseful:[["topSites"],["chrome://favicon/"]],searchSuggest:[[],["https://suggestion.baidu.com/","https://google.com/"]],gmailNotice:[["notifications"],["https://mail.google.com/"]],gmailCount:[[],["https://mail.google.com/"]],todoNotice:[["notifications"],[]]},this.showSettingHomeModal=!1,this.webClickName=""}init(t={}){return{notice:Object.assign({},a.b.notice),link:Object.assign({},a.b.link),view:Object.assign({},a.b.view),layout:Object.assign({},a.b.layout),animation:Object.assign({},a.b.animation),icon:Object.assign({},a.b.icon),search:Object.assign({},a.b.search),font:Object.assign({},a.b.font),_v1Setting:t}}get withPermissionTopUseful(){return this.setting.view.topUseful&&1===this.permission.topUseful}get withPermissionTopBookmark(){return this.setting.view.topBookmark&&1===this.permission.topBookmark}get withPermissionSearchSuggest(){return this.setting.search.searchSuggest&&1===this.permission.searchSuggest}get needPermissionList(){const t=[],{view:e,notice:i,search:o}=this.setting,{topUseful:s,topBookmark:n,searchSuggest:r,gmailNotice:a,gmailCount:c,todoNotice:h}=this.permission;return l.m&&o.searchSuggest&&1!==r&&t.push({key:"searchSuggest",title:i18n("permission_serch_suggest_title"),content:i18n("permission_serch_suggest_content")}),l.m&&i.gmail&&1!==a&&t.push({key:"gmailNotice",title:i18n("permission_gmail_notice_title"),content:i18n("permission_gmail_notice_content")}),l.m&&i.gmailNumber&&1!==c&&t.push({key:"gmailCount",title:i18n("permission_gmail_num_title"),content:i18n("permission_gmail_num_content")}),!l.r&&e.topBookmark&&1!==n&&t.push({key:"topBookmark",title:i18n("permission_top_bookmark_title"),content:i18n("permission_top_bookmark_content")}),!l.r&&e.topUseful&&1!==s&&t.push({key:"topUseful",title:i18n("permission_top_useful_title"),content:i18n("permission_top_useful_content")}),p.a.needNotificationPermission&&1!==h&&(l.r&&"denied"===Notification.permission||t.push({key:"todoNotice",title:i18n("permission_todo_notice_title"),content:i18n("permission_todo_notice_content")})),t}get sideRatio(){return this.setting.view.scaleSide}reset(){this.setting=this.init(this.setting._v1Setting)}diffRemote(t){return!o.d.structural(t.setting||{},this.setting)}sendSettingValue(){Object.keys(this.localSettings).length&&(u.a.sendEvent({settingValue:this.localSettings}),this.localSettings={})}async mergeRemote(t){const e=t.setting;if(!t.setting)return;const i=this.setting;this.setting={notice:Object.assign(Object.assign({},i.notice),e.notice),link:Object.assign(Object.assign({},i.link),e.link),view:Object.assign(Object.assign({},i.view),e.view),layout:Object.assign(Object.assign({},i.layout),e.layout),animation:Object.assign(Object.assign({},i.animation),e.animation),icon:Object.assign(Object.assign({},i.icon),e.icon),search:Object.assign(Object.assign({},i.search),e.search),font:Object.assign(Object.assign({},i.font),e.font),_v1Setting:e._v1Setting};const s=await n.a.getTimestamp();Object(o.i)(()=>{this.updatetime=s})}sendSettingLog(t,e){this.logs.has(t)&&clearTimeout(this.logs.get(t)),this.logs.set(t,setTimeout(()=>{u.a.sendEvent({settingAction:{[t]:e}}),this.logs.delete(t)},2e3))}async changeSetting(t,e,i){if(this.setting[t][e]===i)return;this.setting[t][e]=i;let s=`${t}_${e}`,r=i;"layout"!==t||"col"!==e&&"row"!==e||(s="layout",r=this.setting.layout.row+"*"+this.setting.layout.col),this.sendSettingLog(s,r),this.localSettings[s]=r;const a=await n.a.getTimestamp();Object(o.i)(()=>{this.updatetime=a}),this.changeSettingEffect(t,e,i)}changeSettingEffect(t,e,i){switch(!0){case"topBookmark"===e:i&&this.requestPermission("topBookmark",!0);break;case"topUseful"===e:i&&this.requestPermission("topUseful",!0);break;case"notice"===t&&"gmail"===e:i&&this.requestPermission("gmailNotice",!0);break;case"notice"===t&&"gmailNumber"===e:i&&this.requestPermission("gmailCount",!0);break;case"searchSuggest"===e:i&&this.requestPermission("searchSuggest",!0)}}async checkPermission(t){if(l.r){switch(t){case"todoNotice":"granted"===Notification.permission?this.permission[t]=1:"default"===Notification.permission?this.permission[t]=-1:this.permission[t]=0}return}if(1===this.permission[t])return;const e=this.permissionMapper[t];try{await r.a.has(e[0],e[1])&&Object(o.i)(()=>{this.permission[t]=1})}catch(t){}}async requestPermission(t,e=!1){if(l.r&&["todoNotice"].includes(t))return await Object(h.a)(),void Object(o.i)(()=>{this.permission.todoNotice=1});const i=this.permissionMapper[t];if(e||0!==this.permission[t]&&1!==this.permission[t])try{await r.a.request(i[0],i[1]),Object(o.i)(()=>{this.permission[t]=1}),"gmailNotice"===t&&this.checkPermission("todoNotice")}catch(e){e&&"REJECT"===e.message&&Object(o.i)(()=>{this.permission[t]=0})}}async requestAllPermission(){if(l.r)return await Object(h.a)(),void Object(o.i)(()=>{this.permission.todoNotice=1});const t=[[],[]];this.needPermissionList.forEach(e=>{const i=this.permissionMapper[e.key];t[0].push(...i[0]),i&&t[1].push(...i[1])});try{await r.a.request(t[0],t[1]),Object(o.i)(()=>{this.needPermissionList.forEach(t=>{this.permission[t.key]=1})})}catch(t){Object(o.i)(()=>{this.needPermissionList.forEach(t=>{this.permission[t.key]=0})})}}resetPermission(t){this.permission[t]=-1}setIconSpace(t){this.setting.icon.scale=t.iconScale,this.setting.layout.colGap=t.colGap,this.setting.layout.rowGap=t.rowGap,this.setting.search.scale=t.searchScale}openSearchSuggest(){this.setting.search.searchSuggest?this.requestPermission("searchSuggest",!0):this.setting.search.searchSuggest=!0}get sideScaleRatio(){return this.setting.view.scaleSide}toggleShowSettingHome(t){this.setting.view.isShowHomepageBtn=!t}toggleSettingHomeModal(){this.webClickName="",this.showSettingHomeModal=!this.showSettingHomeModal}closeSettingHomeModal(){this.showSettingHomeModal=!1}setWebClickName(t){this.webClickName=t}}d([o.g],g.prototype,"innerWidth",void 0),d([o.g],g.prototype,"innerHeight",void 0),d([o.g],g.prototype,"iconSpaceWidth",void 0),d([o.g],g.prototype,"iconSpaceHeight",void 0),d([o.g],g.prototype,"setting",void 0),d([o.g],g.prototype,"updatetime",void 0),d([o.g],g.prototype,"permission",void 0),d([o.e],g.prototype,"withPermissionTopUseful",null),d([o.e],g.prototype,"withPermissionTopBookmark",null),d([o.e],g.prototype,"withPermissionSearchSuggest",null),d([o.e],g.prototype,"needPermissionList",null),d([o.e],g.prototype,"sideRatio",null),d([o.b],g.prototype,"reset",null),d([o.b],g.prototype,"mergeRemote",null),d([o.b],g.prototype,"changeSetting",null),d([o.b],g.prototype,"checkPermission",null),d([o.b],g.prototype,"requestPermission",null),d([o.b],g.prototype,"requestAllPermission",null),d([o.b],g.prototype,"resetPermission",null),d([o.b],g.prototype,"setIconSpace",null),d([o.b],g.prototype,"openSearchSuggest",null),d([o.e],g.prototype,"sideScaleRatio",null),d([o.b],g.prototype,"toggleShowSettingHome",null),d([o.g],g.prototype,"showSettingHomeModal",void 0),d([o.b],g.prototype,"toggleSettingHomeModal",null),d([o.b],g.prototype,"closeSettingHomeModal",null),d([o.g],g.prototype,"webClickName",void 0),d([o.b],g.prototype,"setWebClickName",null);const b=new g;b.initSyncStore("store-setting",["setting","permission","updatetime"],a.b),b.initAutoBackup("setting",["setting"]),Object(o.c)(()=>{b.firstSync&&b.setting.view.topBookmark&&b.checkPermission("topBookmark")},{delay:50}),Object(o.c)(()=>{b.firstSync&&b.setting.view.topUseful&&b.checkPermission("topUseful")},{delay:50}),Object(o.c)(()=>{b.firstSync&&b.setting.notice.gmail&&b.checkPermission("gmailNotice")},{delay:50}),Object(o.c)(()=>{p.a.firstSync&&p.a.needNotificationPermission&&b.checkPermission("todoNotice")},{delay:50}),Object(o.c)(()=>{b.firstSync&&b.setting.notice.gmailNumber&&b.checkPermission("gmailCount")},{delay:50}),Object(o.c)(()=>{b.firstSync&&b.setting.search.searchSuggest&&b.checkPermission("searchSuggest")},{delay:50}),Object(o.c)(()=>{b.firstSync&&1===b.permission.gmailNotice&&n.a.send({key:"bg-notice-gmail-permission",data:!0})}),Object(o.c)(()=>{if(b.firstSync){const{gmail:t,gmailVoice:e,gmailNumber:i}=b.setting.notice,{gmailCount:o,gmailNotice:s}=b.permission;n.a.send({key:"bg-notice-gmail-updated",data:{gmail:t&&1===s,gmailVoice:e,gmailNumber:i&&(1===s||1===o)}})}},{delay:100}),Object(o.c)(()=>{if(!0===b.setting.layout.custom){const{customItem:t}=b.setting.layout;Object(o.i)(()=>{b.setting.layout.row=t[0],b.setting.layout.col=t[1]})}}),Object(o.c)(()=>{if(b.firstSync){const t={"--side-ratio":b.sideRatio,"--main-ratio":b.setting.view.scaleMain,"--icon-radius":Math.round(100*b.setting.icon.radius)+"%","--icon-font-color":b.setting.font.color,"--icon-font-size":Math.ceil(Math.max(b.setting.font.size*b.setting.view.scaleMain,12))+"px","--icon-opacity":b.setting.icon.opacity,"--icon-visible":b.setting.icon.isHideIconName?"hidden":"visible","--search-radius":""+b.setting.search.radius,"--search-opacity":b.setting.search.opacity};n.a.setStyle(t)}},{delay:50}),Object(o.c)(()=>{if(b.firstSync){let t=0,e=20;b.withPermissionTopBookmark&&(t+=36),b.withPermissionTopUseful&&(e+=26);const i={"--top-bar-height":t+"px","--settings-icon-top-offset":e+"px"};n.a.setStyle(i)}});const m=t=>{const e={"--search-height":t.searchHeight,"--search-width":t.searchWidth,"--search-margin-top":t.searchMarginTop,"--search-margin-bottom":t.searchMarginBottom,"--search-ratio":t.searchRatio,"--icon-box-width":t.iconBoxWidth,"--icon-box-height":t.iconBoxHeight,"--icon-one-height":t.iconOneHeight,"--icon-width":t.iconWidth,"--mini-icon-padding":t.miniIconPadding,"--icon-ratio":t.iconRatio,"--icon-row":b.setting.layout.row,"--icon-col":b.setting.layout.col,"--main-icons-margin":t.iconsMargin};n.a.setStyle(e)},y=(t=!0)=>{const e={row:b.setting.layout.row,col:b.setting.layout.col,rowGap:b.setting.layout.rowGap,colGap:b.setting.layout.colGap,iconScale:b.setting.icon.scale,searchScale:b.setting.search.scale,innerHeight:innerHeight,innerWidth:innerWidth,miniMode:b.setting.icon.miniMode,fontSize:b.setting.font.size,topUseful:b.withPermissionTopUseful,topBookmark:b.withPermissionTopBookmark,mainRatio:b.setting.view.scaleMain};if(t)requestIdleCallback(()=>{const t=Object(c.a)(e);m(t)});else{const t=Object(c.a)(e);m(t)}};Object(o.c)(()=>{b.firstSync&&y(!1)},{delay:40}),window.addEventListener("resize",n.a.throttle(()=>{y(!1)},56))},392:function(t,e,i){"use strict";i.r(e),i.d(e,"pluginStore",(function(){return p}));i(13),i(17),i(10);var o=i(3),s=i(97),n=i(359);class r extends n.a{opened(t){}}const a=Object(n.b)(new r);var c=function(t,e,i,o){var s,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(n<3?s(r):n>3?s(e,i,r):s(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};class l{constructor(){this.pluginsMap={"infinity://weather":"side-weather","infinity://todos":"side-todos","infinity://notes":"side-notes","infinity://history":"side-history","infinity://bookmarks":"side-bookmarks","infinity://extension":"side-extension","infinity://chrome-apps":"chrome-apps","infinity://wallpaper":"wallpaper","infinity://settings":"side-profile",search:"side-search",profile:"side-profile",editIcon:"side-editicon","side-tutorial":"side-tutorial"},this.pluginsTags={"side-weather":!1,"side-todos":!1,"side-notes":!1,"side-history":!1,"side-bookmarks":!1,"side-extension":!1,"chrome-apps":!1,"side-profile":!1,"side-search":!1,"side-editicon":!1,"side-tutorial":!1,wallpaper:!1},this.pluginViews=[],this.focusRepair=!1,Object(o.h)(()=>this.pluginViews.map(t=>t),([t])=>{a.opened(t)})}initDom(t){this.pluginsTags[t]=!0}async show(t){if(this.pluginViews.includes(t))return;const e=this.pluginsMap[t];if(!1===this.pluginsTags[e])try{await this.requestPermission(e),Object(o.i)(()=>{this.pluginsTags[e]=!0,this.pluginViews.push(t)})}catch(t){}else this.pluginViews.push(t)}async showRepair(){this.focusRepair=!0,this.show("profile"),localStorage.setItem("user-checkout-old-data","true")}blurRepair(){this.focusRepair=!1}requestPermission(t){switch(t){case"side-bookmarks":return s.a.request(["bookmarks"],["chrome://favicon/"]);case"side-extension":case"chrome-apps":return s.a.request(["management"]);case"side-history":return s.a.request(["history"],["chrome://favicon/"])}}hideLast(){const t=this.pluginViews.pop();return 0===this.pluginViews.length&&document.getElementsByTagName("newtab-main")[0].shadowRoot.querySelector(".swiper-content").style.setProperty("transform","none"),t}}c([o.g],l.prototype,"pluginsTags",void 0),c([o.b],l.prototype,"initDom",null),c([o.g],l.prototype,"pluginViews",void 0),c([o.g],l.prototype,"focusRepair",void 0),c([o.b],l.prototype,"show",null),c([o.b],l.prototype,"showRepair",null),c([o.b],l.prototype,"blurRepair",null),c([o.b],l.prototype,"hideLast",null);const p=new l},393:function(t,e,i){t.exports=i.p+"images/error.f782e7c.png"},394:function(t,e,i){t.exports=i.p+"images/remind.896ff6f.png"}}]);